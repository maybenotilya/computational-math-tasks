# Задача 1. Библиотека OpenMP

Давайте рассмотрим книгу В. П. Гергеля “Высокопроизводительные вычисления для
многоядерных многопроцессорных систем” (2010). В главе 11 "Решение
дифференциальных уравнений в частных производных", описывающей проблему
численного решения задачи Дирихле для уравнения Пуассона, содержится алгоритм
11.6 (Блочный подход к методу волновой обработки данных) её решения, который
может быть эффективно распараллелен при помощи OpenMP.
В первой части задания вам следует просто разобраться в этом алгоритме и
реализовать его. Обратите внимание, что он возникает итерационно. Например,
алгоритм 11.2 является корректным, но распараллеливание приводит к замедлению в
25 раз вместо ускорения.
Вторая часть задания — провести численный эксперимент, исследующий
эффективность (или неэффективность) параллельной версии. Модельные краевые
задачи необходимо выбрать самостоятельно, исходя из того, что вы хотели бы теми
или иными экспериментами продемонстрировать. Это наиболее сложная часть
задания.

# Теория
Рассмотрим сетку размером `NB x NB` блоков. Посчитаем, сколько "шагов" нужно для обработки всех блоков во время одной итерации.
* Последовательный алгоритм. Очевидно, придется обработать каждый блок, поэтому потребуется `NB * NB` шагов.
* Параллельный алгоритм. Пусть алгоритм исполняется на `nthreads` потоках. Во время параллельного исполнения за один шаг может обрабатываться вплоть до `nthreads` блоков, но только в рамках одной волны. Таким образом, потребуется $2\displaystyle\sum_{i = 1}^{NB - 1} ceil(i / nthreads) + ceil(NB / nthreads)$.

Тогда рассмотрим ускорения (буз учета других затрат, таких как синхронизация и тд.) для некоторых значений `NB` при фиксированном значении `nthreads = 8`:
|   NB  | Ускорение |
|-------|-----------|
|   2   |   1.33    |
|   4   |   2.29    |
|   8   |   4.27    |
|   16  |   5.57    |

# Эксперимент

Рассмотрим фиксированные размер сетки `N = 1024`, порог вычисления ошибки `eps = 0.1` и размеры блоков `block_size`, равные 205, 128 и 64 (им отвечают `NB`, равные 5, 8 и 16 соответственно).

В качестве модельных задач рассмотрим две: 
* Задачу из книги
    * $f(x, y) = 0$
    * $g(x, y) = $

        $100 - 200x, ~y = 0$

        $100 - 200y, ~x = 0$

        $-100 + 200x, ~y = 1$

        $-100 + 200y, ~x = 1$

* Задачу 1
    * $f(x, y) = \dfrac{5000}{xy}$
    * $g(x, y) = 100x^2 + 200y^3$

Задачи выбирались исходя из количества итераций, необходимых для приближения с заданной точностью.




Для книги
| Размер блока | NB | Кол-во итераций | Время работы для 1 потока | Время работы для 8 потоков | Ускорение |
|--------------|----|-----------------|---------------------------|----------------------------|-----------|
|     64       | 16 |      353        |          1210 ms          |         561 ms             |    2.16   |
|    128       |  8 |      353        |          1221 ms          |         710 ms             |    1.72   |
|    256       |  4 |      353        |          1134 ms          |         753 ms             |    1.50   |
|    512       |  2 |      353        |          1108 ms          |         910 ms             |    1.22   |


Для задачи 1
| Размер блока | NB | Кол-во итераций | Время работы для 1 потока | Время работы для 8 потоков | Ускорение |
|--------------|----|-----------------|---------------------------|----------------------------|-----------|
|     64       | 16 |     14496       |        43990 ms           |           11014 ms         |    4.0    |
|    128       |  8 |     14496       |        42819 ms           |           14051 ms         |    3.04   |
|    256       |  4 |     14496       |        43404 ms           |           26719 ms         |    1.62   |
|    512       |  2 |     14496       |        42755 ms           |           39034 ms         |    1.10   |
